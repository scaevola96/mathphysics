(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     14541,        372]
NotebookOptionsPosition[     13102,        342]
NotebookOutlinePosition[     13443,        357]
CellTagsIndexPosition[     13400,        354]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Needs", "[", "\"\<Combinatorica`\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.81260943367414*^9, 3.812609437471958*^9}, 
   3.812609487085516*^9, {3.812613164599305*^9, 3.8126131648455043`*^9}, {
   3.8126147966478653`*^9, 3.8126148063157864`*^9}, {3.8126290214514627`*^9, 
   3.8126290227388835`*^9}},ExpressionUUID->"8993dafa-411c-49aa-b250-\
21f48e1cbcba"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ValidPartitionQ", "[", "partition_", "]"}], ":=", 
  RowBox[{
   RowBox[{"VectorQ", "[", 
    RowBox[{"partition", ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"IntegerQ", "[", "#", "]"}], "&&", 
        RowBox[{"NonNegative", "[", "#", "]"}]}], ")"}], "&"}]}], "]"}], "&&", 
   RowBox[{"Apply", "[", 
    RowBox[{"GreaterEqual", ",", "partition"}], "]"}], " "}]}]], "Input",
 CellLabel->"In[86]:=",ExpressionUUID->"21ac5f20-8907-408c-bd84-5623ae1e72d1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"EncodeDiagram", "[", 
    RowBox[{"partition_List", "?", "ValidPartitionQ"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"par", "=", " ", "partition"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{"Append", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"ConstantArray", "[", 
                RowBox[{"0", ",", "#"}], "]"}], ",", "1"}], "]"}], "&"}], ",",
             "\[IndentingNewLine]", "\t", 
            RowBox[{"Abs", "[", 
             RowBox[{"Differences", "[", "par", "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], "]"}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SequenceCenter", " ", "[", "seq_List", "]"}], ":=", 
   RowBox[{"Module", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", "=", "1"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{
           RowBox[{"seq", "[", 
            RowBox[{"[", 
             RowBox[{";;", "n"}], "]"}], "]"}], ",", "1"}], "]"}], "!=", 
         RowBox[{"Count", "[", 
          RowBox[{
           RowBox[{"seq", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"n", "+", "1"}], ";;"}], "]"}], "]"}], ",", "0"}], 
          "]"}]}], ",", 
        RowBox[{"n", "++"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{"n", ",", 
         RowBox[{"n", "+", "1"}]}], "}"}], "]"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BeadSlide", "[", "abacus_List", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"trans", " ", "=", 
       RowBox[{"Transpose", "[", "abacus", "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Transpose", "[", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"PadLeft", "[", 
          RowBox[{
           RowBox[{"ConstantArray", "[", 
            RowBox[{"1", ",", 
             RowBox[{"Count", "[", 
              RowBox[{"#", ",", "1"}], "]"}]}], "]"}], ",", 
           RowBox[{"Length", "[", "#", "]"}]}], "]"}], "&"}], ",", "trans"}], 
       " ", "]"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AbacusDiagram", "[", 
   RowBox[{"seq_List", ",", "div_Integer"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"s", "=", "seq"}], ",", " ", 
      RowBox[{"p", "=", "div"}], ",", "  ", 
      RowBox[{"center", " ", "=", "  ", 
       RowBox[{"SequenceCenter", "[", "seq", "]"}]}], " ", ",", " ", "lhs", 
      ",", "rhs", ",", " ", "above", ",", " ", "below"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"lhs", " ", "=", 
      RowBox[{"s", "[", 
       RowBox[{"[", 
        RowBox[{";;", 
         RowBox[{"center", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], " ", ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rhs", " ", "=", " ", 
      RowBox[{"s", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"center", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ";;"}], "]"}], "]"}]}], " ", ";", 
     "\[IndentingNewLine]", 
     RowBox[{"above", " ", "=", " ", 
      RowBox[{"Partition", "[", 
       RowBox[{
        RowBox[{"PadLeft", "[", 
         RowBox[{"lhs", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Quotient", "[", 
              RowBox[{
               RowBox[{"Length", "[", "lhs", "]"}], ",", "p"}], "]"}], "+", 
             "2"}], ")"}], "*", "p"}], ",", "0"}], "]"}], ",", "p"}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"below", " ", "=", " ", 
      RowBox[{"Partition", "[", 
       RowBox[{
        RowBox[{"PadRight", "[", 
         RowBox[{"rhs", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Quotient", "[", 
              RowBox[{
               RowBox[{"Length", "[", "rhs", "]"}], ",", "p"}], "]"}], "+", 
             "2"}], ")"}], "*", "p"}], ",", "1"}], "]"}], ",", "p"}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"Join", "[", 
       RowBox[{"above", ",", "below"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{
  3.812611096150704*^9, {3.8126111415152626`*^9, 3.8126111461100483`*^9}, {
   3.8126112321657577`*^9, 3.812611236411769*^9}, {3.8126114094833155`*^9, 
   3.8126114381101727`*^9}, {3.81261210905396*^9, 3.8126121351897545`*^9}, {
   3.812612391467536*^9, 3.812612397220567*^9}, {3.8126125270457735`*^9, 
   3.8126125280440545`*^9}, {3.8126125622140226`*^9, 3.812612612320616*^9}, {
   3.812612695973129*^9, 3.8126127052641373`*^9}, {3.8126127709499273`*^9, 
   3.8126127911817484`*^9}, {3.8126128680415907`*^9, 
   3.8126131015207567`*^9}, {3.8126131689246173`*^9, 3.812613214039325*^9}, {
   3.8126143170865016`*^9, 3.812614333090912*^9}, {3.812614663555862*^9, 
   3.8126146751944895`*^9}, {3.812614794239049*^9, 3.812614848989971*^9}, {
   3.8126155969791317`*^9, 3.812615661525966*^9}, {3.8126157443416653`*^9, 
   3.8126158001030164`*^9}, {3.8126160783850007`*^9, 3.812616085521041*^9}, {
   3.812616486850665*^9, 3.812616506720216*^9}, {3.8126169834159107`*^9, 
   3.8126172019577656`*^9}, {3.812617238424429*^9, 3.8126172622302895`*^9}, {
   3.8126209687525473`*^9, 3.812620969688609*^9}, {3.8126250394404097`*^9, 
   3.812625053418827*^9}, {3.8126289727666535`*^9, 3.8126290174308577`*^9}},
 CellLabel->
  "In[274]:=",ExpressionUUID->"30931095-16ee-4074-bdf1-b16a33f6e2fb"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8126148516022234`*^9, 3.8126148727160015`*^9}, {
  3.81261604356726*^9, 3.8126160501620874`*^9}, {3.812616101716628*^9, 
  3.812616133452453*^9}},
 CellLabel->"In[97]:=",ExpressionUUID->"252be700-d535-4d0f-94af-3380916091cc"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"EncodeDiagram", "[", 
   RowBox[{"{", 
    RowBox[{"5", ",", "5", ",", "4", ",", "1", ",", "1"}], "}"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8126290366445217`*^9, 3.812629037350782*^9}},
 CellLabel->
  "In[278]:=",ExpressionUUID->"284eb9ef-ad69-4e69-ac3f-1c7e83260f93"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"seq", "=", 
  RowBox[{"{", 
   RowBox[{
   "0", ",", "1", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", 
    ",", "1", ",", "1", ",", "0", ",", "1"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.8126290421063604`*^9, 3.812629046686221*^9}},
 CellLabel->
  "In[279]:=",ExpressionUUID->"6259c7c1-1d7a-4157-b1eb-21bc081869e3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "1", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", 
   ",", "1", ",", "1", ",", "0", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{3.812629048268216*^9},
 CellLabel->
  "Out[279]=",ExpressionUUID->"8fe35c9e-9158-4dba-8d6e-ad33364a10b3"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"SequenceCenter", "[", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "1", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0",
      ",", "1", ",", "1", ",", "0", ",", "1"}], "}"}], "]"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellLabel->
  "In[280]:=",ExpressionUUID->"49fecc69-e0ab-4cd0-aa8e-28e86c6e41b7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"AbacusDiagram", "[", 
   RowBox[{"seq", ",", "p"}], "]"}], "//", "ArrayPlot"}]], "Input",
 CellChangeTimes->{{3.812624082111785*^9, 3.8126240987796745`*^9}, {
   3.8126245816843596`*^9, 3.8126246297853737`*^9}, {3.8126247368124437`*^9, 
   3.812624894168521*^9}, {3.8126249651860385`*^9, 3.8126250073357787`*^9}, {
   3.8126250724998837`*^9, 3.812625213914287*^9}, {3.812625254996337*^9, 
   3.812625288225788*^9}, {3.8126254286851945`*^9, 3.8126255094729323`*^9}, {
   3.812626073305005*^9, 3.812626095526764*^9}, {3.8126263564232445`*^9, 
   3.812626463304708*^9}, {3.8126265162060823`*^9, 3.812626564428306*^9}, {
   3.812627656769379*^9, 3.812627673939986*^9}, {3.812627743620009*^9, 
   3.812627850848629*^9}, {3.812627893110343*^9, 3.812628095136306*^9}, 
   3.812628984648604*^9, {3.8126291175721855`*^9, 3.812629137767891*^9}},
 CellLabel->
  "In[282]:=",ExpressionUUID->"b8ab25f0-0f71-481d-8964-7a8d45e55630"],

Cell[BoxData[
 GraphicsBox[
  RasterBox[{{0, 0, 0, 0}, {0, 1, 0, 0}, {1, 1, 1, 0}, {0, 1, 0, 1}, {1, 1, 1,
    0}, {1, 1, 1, 1}}, {{0, 0}, {4, 6}}, {0, 1}],
  Frame->Automatic,
  FrameLabel->{None, None},
  FrameTicks->{{None, None}, {None, None}},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultPlotStyle" -> 
    Automatic}]], "Output",
 CellChangeTimes->{{3.8126291285794907`*^9, 3.812629138662686*^9}},
 CellLabel->
  "Out[282]=",ExpressionUUID->"14ea689e-72f4-4ac5-b73b-7d48958ccc46"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"BeadSlide", "[", 
   RowBox[{"AbacusDiagram", "[", 
    RowBox[{"seq", ",", "p"}], "]"}], "]"}], "//", "ArrayPlot"}]], "Input",
 CellChangeTimes->{{3.8126276268354983`*^9, 3.8126276274647837`*^9}, {
  3.8126282922865725`*^9, 3.81262833166895*^9}, {3.812628368199404*^9, 
  3.8126283724329343`*^9}, {3.8126286835789595`*^9, 3.8126286909161797`*^9}, {
  3.8126287694969544`*^9, 3.8126287897425313`*^9}, {3.812628876806771*^9, 
  3.812628877835881*^9}, {3.812628945073604*^9, 3.8126289482747836`*^9}, {
  3.812629146842699*^9, 3.812629154490471*^9}},
 CellLabel->
  "In[283]:=",ExpressionUUID->"c18e14db-d201-4ef5-a622-20aec0b8a8d5"],

Cell[BoxData[
 GraphicsBox[
  RasterBox[{{0, 0, 0, 0}, {0, 1, 0, 0}, {0, 1, 0, 0}, {1, 1, 1, 0}, {1, 1, 1,
    1}, {1, 1, 1, 1}}, {{0, 0}, {4, 6}}, {0, 1}],
  Frame->Automatic,
  FrameLabel->{None, None},
  FrameTicks->{{None, None}, {None, None}},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultPlotStyle" -> 
    Automatic}]], "Output",
 CellChangeTimes->{{3.8126283241180253`*^9, 3.8126283322630296`*^9}, 
   3.8126283728847504`*^9, {3.8126286851470785`*^9, 3.8126286914027395`*^9}, {
   3.812628774359469*^9, 3.8126287910325184`*^9}, 3.8126288783808975`*^9, 
   3.812628949561552*^9, 3.8126291559255*^9},
 CellLabel->
  "Out[283]=",ExpressionUUID->"816d887c-1179-46d0-9e1d-d6ab2eb88675"]
}, Open  ]]
},
WindowSize->{1520, 781},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 441, 9, 48, "Input",ExpressionUUID->"8993dafa-411c-49aa-b250-21f48e1cbcba"],
Cell[1002, 31, 516, 13, 28, "Input",ExpressionUUID->"21ac5f20-8907-408c-bd84-5623ae1e72d1"],
Cell[1521, 46, 6248, 159, 447, "Input",ExpressionUUID->"30931095-16ee-4074-bdf1-b16a33f6e2fb"],
Cell[7772, 207, 274, 4, 28, "Input",ExpressionUUID->"252be700-d535-4d0f-94af-3380916091cc"],
Cell[8049, 213, 336, 8, 48, "Input",ExpressionUUID->"284eb9ef-ad69-4e69-ac3f-1c7e83260f93"],
Cell[CellGroupData[{
Cell[8410, 225, 358, 8, 28, InheritFromParent,ExpressionUUID->"6259c7c1-1d7a-4157-b1eb-21bc081869e3"],
Cell[8771, 235, 305, 7, 32, "Output",ExpressionUUID->"8fe35c9e-9158-4dba-8d6e-ad33364a10b3"]
}, Open  ]],
Cell[9091, 245, 349, 9, 48, "Input",ExpressionUUID->"49fecc69-e0ab-4cd0-aa8e-28e86c6e41b7"],
Cell[CellGroupData[{
Cell[9465, 258, 953, 15, 28, "Input",ExpressionUUID->"b8ab25f0-0f71-481d-8964-7a8d45e55630"],
Cell[10421, 275, 879, 21, 449, "Output",ExpressionUUID->"14ea689e-72f4-4ac5-b73b-7d48958ccc46"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11337, 301, 665, 12, 28, "Input",ExpressionUUID->"c18e14db-d201-4ef5-a622-20aec0b8a8d5"],
Cell[12005, 315, 1081, 24, 449, "Output",ExpressionUUID->"816d887c-1179-46d0-9e1d-d6ab2eb88675"]
}, Open  ]]
}
]
*)

